# Manual Maker - 要件定義書

## 1. プロジェクト概要

### 1.1 目的
PC画面操作を自動記録し、PowerPoint形式のマニュアルを効率的に作成するデスクトップアプリケーションの開発

### 1.2 ターゲットユーザー
- 業務マニュアルを頻繁に作成する必要がある担当者
- ITサポート部門・ヘルプデスク担当者
- 新人研修用の資料を作成する教育担当者
- ソフトウェア製品のマニュアル作成者

### 1.3 解決する課題
- 手動でスクリーンショットを撮影・整理する手間
- マニュアル作成の時間とコストの削減
- 操作手順の記録漏れの防止
- 一貫性のあるマニュアルフォーマットの提供

---

## 2. 機能要件

### 2.1 MVP機能（Phase 1）

#### 2.1.1 収録モード
- **FR-1.1**: マウスクリックを検知してスクリーンショットを自動撮影する
- **FR-1.2**: キーボード入力を検知してスクリーンショットを自動撮影する
- **FR-1.3**: スクリーンショットを連番付きで保存する
- **FR-1.4**: 収録開始/停止機能を提供する（Ctrl+C）
- **FR-1.5**: 撮影した画像数をリアルタイムで表示する

#### 2.1.2 編集モード
- **FR-2.1**: 撮影したスクリーンショット一覧をグリッド表示する
- **FR-2.2**: 各画像に説明文（テキスト）を追加できる
- **FR-2.3**: 不要な画像を削除できる
- **FR-2.4**: 削除操作をUndo（取り消し）できる
- **FR-2.5**: 画像の順序を並び替えできる（ドラッグ&ドロップまたは番号指定）
- **FR-2.6**: 編集内容を自動保存する

#### 2.1.3 出力機能
- **FR-3.1**: PowerPoint形式（.pptx）でマニュアルを生成する
- **FR-3.2**: 1スライド = 1画像 + 説明文 の形式で出力する
- **FR-3.3**: 画像をスライド内に適切なサイズで配置する
- **FR-3.4**: 生成したPowerPointファイルをダウンロードできる

#### 2.1.4 セッション管理
- **FR-4.1**: 収録セッションごとにディレクトリを作成する
- **FR-4.2**: セッション一覧を表示する
- **FR-4.3**: 過去のセッションを再編集できる

### 2.2 Phase 2機能（将来実装）

#### 2.2.1 画像注釈機能
- **FR-5.1**: 画像に矢印を追加する
- **FR-5.2**: 画像に枠線・強調表示を追加する
- **FR-5.3**: 画像にテキストボックスを追加する
- **FR-5.4**: 注釈の色・サイズをカスタマイズする

#### 2.2.2 テンプレート機能
- **FR-6.1**: PowerPointテンプレートを選択できる
- **FR-6.2**: カスタムテンプレートをインポートできる
- **FR-6.3**: 会社ロゴ・ヘッダー・フッターを設定できる

#### 2.2.3 高度な収録機能
- **FR-7.1**: 特定ウィンドウのみを収録する
- **FR-7.2**: 収録エリアを指定する
- **FR-7.3**: 自動的にクリック位置をハイライトする
- **FR-7.4**: ホットキーで手動撮影する

#### 2.2.4 出力形式の拡張
- **FR-8.1**: PDF形式で出力する
- **FR-8.2**: HTML形式で出力する
- **FR-8.3**: Markdown形式で出力する

---

## 3. 非機能要件

### 3.1 性能要件
- **NFR-1.1**: スクリーンショット撮影は0.5秒以内に完了すること
- **NFR-1.2**: 1000枚の画像を含むセッションでも編集UIが快適に動作すること
- **NFR-1.3**: PowerPoint生成は100スライドあたり10秒以内に完了すること

### 3.2 ユーザビリティ要件
- **NFR-2.1**: Python環境なしで実行できること（exe化）
- **NFR-2.2**: 初回起動時に使い方のガイドを表示すること
- **NFR-2.3**: 操作ミスによるデータ損失を防ぐこと（自動保存・Undo）
- **NFR-2.4**: 直感的なUI（説明なしで基本操作ができる）

### 3.3 互換性要件
- **NFR-3.1**: Windows 10以降で動作すること
- **NFR-3.2**: macOS 11以降で動作すること
- **NFR-3.3**: 生成したPowerPointはOffice 2016以降で開けること
- **NFR-3.4**: 生成したPowerPointはLibreOfficeで開けること

### 3.4 保守性要件
- **NFR-4.1**: モジュール化された設計で、機能追加が容易であること
- **NFR-4.2**: ユニットテストのカバレッジが80%以上であること
- **NFR-4.3**: コードにドキュメンテーションコメントが含まれること

### 3.5 セキュリティ要件
- **NFR-5.1**: スクリーンショットはローカル環境のみに保存すること
- **NFR-5.2**: 外部サーバーへのデータ送信は行わないこと
- **NFR-5.3**: センシティブ情報を含む可能性があるため、ユーザーに注意喚起すること

### 3.6 配布要件
- **NFR-6.1**: PyInstallerでexe/app形式にビルドできること
- **NFR-6.2**: 依存ライブラリを含む単一実行ファイルとして配布できること
- **NFR-6.3**: インストーラーは不要（ポータブル実行）

---

## 4. 制約事項

### 4.1 技術的制約
- Python 3.9以降を使用
- Streamlitをベースとしたウェブベースのローカルアプリケーション
- マルチモニタ環境では全画面をキャプチャ（モニタ選択は将来対応）

### 4.2 スコープ外
- クラウドストレージへの自動保存
- 複数ユーザーでの共同編集
- ビデオ録画機能
- 音声録音機能
- OCR（画像内テキスト認識）

### 4.3 既知の制限
- macOSでは画面収録権限の許可が必要
- Windowsでは管理者権限で実行されたアプリの操作は検知できない可能性
- デバウンス時間（0.5秒）内の連続操作は1回としてカウント

---

## 5. ユーザーストーリー

### US-1: 基本的なマニュアル作成
**As a** 業務マニュアル作成担当者
**I want to** PC操作を自動記録してPowerPointを生成したい
**So that** マニュアル作成時間を短縮できる

**受け入れ基準**:
- 収録モードで操作を記録できる
- 編集モードで画像に説明を追加できる
- PowerPointファイルが生成される

### US-2: 編集とやり直し
**As a** マニュアル作成者
**I want to** 撮影した画像を編集・削除できる
**So that** 不要な画像や間違った操作を除外できる

**受け入れ基準**:
- 画像を削除できる
- 削除をUndoできる
- 順序を並び替えできる

### US-3: 過去のセッションの再利用
**As a** マニュアル更新担当者
**I want to** 過去に作成したセッションを再編集したい
**So that** 内容を更新して新しいマニュアルを作成できる

**受け入れ基準**:
- セッション一覧が表示される
- 過去のセッションを開ける
- 編集して再出力できる

### US-4: スタンドアロン実行
**As a** エンドユーザー
**I want to** Pythonをインストールせずにアプリを使いたい
**So that** 簡単に導入できる

**受け入れ基準**:
- exeファイルをダブルクリックで起動できる
- 依存関係のインストールが不要
- Windows/Mac両方で動作する

---

## 6. 成功指標

### 6.1 定量的指標
- マニュアル作成時間を従来比70%削減
- ユーザー満足度スコア4.0/5.0以上
- 初回起動からマニュアル生成まで10分以内

### 6.2 定性的指標
- 直感的で使いやすいUIと評価される
- 業務プロセスに自然に組み込まれる
- ユーザーが自発的に使い続ける

---

## 7. リリース計画

### Phase 1（MVP）: 2週間
- 基本的な収録・編集・出力機能
- exe化とWindows/Mac配布

### Phase 2: 4週間
- 画像注釈機能
- テンプレート機能

### Phase 3: 6週間
- 高度な収録機能
- 複数出力形式対応
